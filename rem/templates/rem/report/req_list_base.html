{% extends "rem/base.html" %}
{% block js %}

{% endblock %}
{% block title %} Request List {% endblock %}
{% block content %}
<br>
<form method="post">
    {% csrf_token %}
    <div class='form-row'>
        <div class="col-auto">
            {% for error in form.date_from.errors %}
              {{ error}}
            {% endfor %}
            {{form.date_from.label_tag}}
            {{form.date_from}}
        </div>
        <div class="col-auto">
            {% for error in form.date_to.errors %}
              {{ error}}
            {% endfor %}
            {{form.date_to.label_tag}}
            {{form.date_to}}
        </div>
        <div class="col-auto">
            {% for error in form.exchange.errors %}
              {{ error}}
            {% endfor %}
            {{form.exchange.label_tag}}
            {{form.exchange}}
        </div>
        <div class="col-auto">
            {% for error in form.status.errors %}
              {{ error}}
            {% endfor %}
            {{form.status.label_tag}}
            {{form.status}}
        </div>
        {% block branch_dropdown %} {% endblock %}
        <div class="col-auto">
            <button type="submit" class="btn btn-primary btn-sm mb-2">Search</button>
        </div>
    </div>
</form>
</br>
{%if req_list %}
{% regroup req_list by remittance.exchange as request_list %}

<fieldset id="group_1">
    {% csrf_token %}
    {% for req in request_list %}
    </br>
    <h4> {{ req.grouper }} </h4>
    <table id="table_{{forloop.counter}}" class='table table-hover table-sm'>
        <thead>
            <tr>
                {% block branch_column %}{% endblock %}
                <th scope="col">Country</th>
                <th scope="col">Ref. No</th>
                <th scope="col">Sender</th>
                <th scope="col">Benificiary</th>
                <th scope="col">Amount</th>
                <th scope="col">Request Posted By</th>
                <th scope="col">Status</th>
                <th scope="col">Resubmit?</th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            {% for entry in req.list %}

            <tr>
                {% block branch_value %}{% endblock %}
                <td>{{entry.remittance.rem_country}}</td>
                <td>{{entry.remittance.reference}}</td>
                <td>{{entry.remittance.sender.title}}</td>
                <td>{{entry.remittance.receiver}}</td>
                <td>{{entry.remittance.amount}}</td>
                <td>{{entry.created_by}}</td>
                <td>{{entry.get_status_display}}</td>
                <td>{{entry.resubmit_flag}}</td>
                {% block button %}{% endblock %}
            </tr>

            {% endfor %}
        </tbody>
    </table>
    {% endfor %}
</fieldset>
{%endif%}
{% block error %}{% endblock %}
{% endblock %}
